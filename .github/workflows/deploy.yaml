name: Deploy

on:
  push:
    branches: [dev]

jobs:
  build-docker:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3.0.2
        with:
          fetch-depth: 0
      - name: Install werf CLI
        uses: werf/actions/install@v1.2
      - name: Build with werf
        env:
          CHAIN_ID: ${{ secrets.CHAIN_ID }}
          CHAIN_NAME: ${{ secrets.CHAIN_NAME }}
          CHAIN_ENDPOINT: ${{ secrets.CHAIN_ENDPOINT }}
          CHAIN_SYMBOL: ${{ secrets.CHAIN_SYMBOL }}
          CHAIN_DECIMALS: ${{ secrets.CHAIN_DECIMALS }}
          GH_CLIENT_ID: ${{ secrets.GH_CLIENT_ID }}
          RECAPTCHA_SITE_KEY: ${{ secrets.RECAPTCHA_SITE_KEY }}
          SERVICE_ENDPOINT: ${{ secrets.SERVICE_ENDPOINT }}
          SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
        run: |-
          source $(werf ci-env github --as-file)
          werf build
